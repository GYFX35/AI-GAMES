<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Free Games from Epic Games Store - Games Universe</title>
    <meta name="description" content="Check out the current free games on the Epic Games Store.">
    <meta name="keywords" content="epic games, free games, pc gaming">
    <link rel="stylesheet" href="style.css">
    <link rel="manifest" href="manifest.json">
</head>
<body>
    <header>
        <div class="container">
            <h1 class="logo">Games Universe</h1>
            <nav>
                <ul>
                    <li><a href="index.html">Home</a></li>
                    <li><a href="games.html">Games</a></li>
                    <li><a href="ai_agent.html">AI Assistant</a></li>
                    <li><a href="developers.html">Developers</a></li>
                    <li><a href="forums.html">Forums</a></li>
                    <li><a href="sponsorship.html">Sponsor Us</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <main>
        <section class="all-games">
            <div class="container">
                <h2>Free Games from Epic Games Store</h2>
                <div id="free-games" class="category-grid">
                    <!-- Free games will be displayed here -->
                </div>
            </div>
        </section>
    </main>

    <footer>
        <div class="container">
            <p>&copy; 2024 Games Universe. All rights reserved.</p>
        </div>
    </footer>

    <script>
        async function fetchFreeGames() {
            try {
                const response = await fetch('/api/epic-games/free-games', {
                    headers: {
                        'X-API-Key': 'test-api-key'
                    }
                });
                const data = await response.json();
                displayFreeGames(data.data.Catalog.searchStore.elements);
            } catch (error) {
                console.error('Error fetching free games:', error);
            }
        }

        function displayFreeGames(games) {
            const container = document.getElementById('free-games');
            container.innerHTML = '';

            if (games.length === 0) {
                container.innerHTML = '<p>No free games found at the moment.</p>';
                return;
            }

            games.forEach(game => {
                const gameCard = document.createElement('div');
                gameCard.className = 'category-card';

                // Find the right image, prefer the thumbnail
                let imageUrl = '';
                if (game.keyImages) {
                    const thumbnail = game.keyImages.find(img => img.type === 'Thumbnail');
                    if (thumbnail) {
                        imageUrl = thumbnail.url;
                    } else if (game.keyImages.length > 0) {
                        imageUrl = game.keyImages[0].url;
                    }
                }

                gameCard.innerHTML = `
                    ${imageUrl ? `<img src="${imageUrl}" alt="${game.title}" style="width:100%;">` : ''}
                    <h3>${game.title}</h3>
                    <p>${game.description}</p>
                    <a href="https://www.epicgames.com/store/en-US/p/${game.productSlug}" target="_blank">Claim Now</a>
                `;
                container.appendChild(gameCard);
            });
        }

        window.onload = fetchFreeGames;
    </script>
</body>
</html>
